/*
 * Instituto de Matematica Pura e Aplicada - IMPA
 * Departamento de Dinamica dos Fluidos
 *
 */
package rpn;

import java.awt.BorderLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JComboBox;
import rpn.usecase.CurvePlotAgent;
import rpnumerics.RpNumerics;

public class RPnCurveConfigPanel extends javax.swing.JPanel {

    public RPnCurveConfigPanel() {
        initComponents();

        //Adding names

        addMethodNames();
        addFlowNames();
        addFamilyIndex();
        directionNames();

        curvePanel.add(CurvePlotAgent.instance().getContainer(), BorderLayout.SOUTH);

        CurvePlotAgent.instance().setEnabled(true);
        

        //Initial configuration of plot agent

        if (((String) flowComboBox.getSelectedItem()).matches(".*Shock.*")) {//TODO HardCoded !!Only to show a possible behaviour
            familyIndexComboBox.setEnabled(false);
            directionComboBox.setEnabled(false);
            CurvePlotAgent.instance().setType("shock");
        } else {
            directionComboBox.setEnabled(true);
            familyIndexComboBox.setEnabled(true);
            CurvePlotAgent.instance().setType("rarefaction");
        }


        if (((String) directionComboBox.getSelectedItem()).matches("Forward")) {
            CurvePlotAgent.instance().setTimeDirection(1);
        } else {
            CurvePlotAgent.instance().setTimeDirection(-1);
        }


        CurvePlotAgent.instance().setMethodName((String) methodComboBox.getSelectedItem());
        CurvePlotAgent.instance().setFlowName((String) flowComboBox.getSelectedItem());
        CurvePlotAgent.instance().setFamilyIndex(((Integer) familyIndexComboBox.getSelectedItem()).intValue());

    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        methodPanel = new javax.swing.JPanel();
        methodComboBox = new javax.swing.JComboBox();
        methodLabel = new javax.swing.JLabel();
        curvePanel = new javax.swing.JPanel();
        flowPanel = new javax.swing.JPanel();
        familyIndexComboBox = new javax.swing.JComboBox();
        familyIndexLabel = new javax.swing.JLabel();
        directionComboBox = new javax.swing.JComboBox();
        directionLabel = new javax.swing.JLabel();
        flowComboBox = new javax.swing.JComboBox();
        flowLabel = new javax.swing.JLabel();

        setLayout(new java.awt.GridBagLayout());

        methodPanel.setLayout(new java.awt.GridBagLayout());

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.gridheight = 3;
        gridBagConstraints.insets = new java.awt.Insets(13, 0, 0, 0);
        methodPanel.add(methodComboBox, gridBagConstraints);

        methodLabel.setText("Method");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.anchor = java.awt.GridBagConstraints.SOUTH;
        methodPanel.add(methodLabel, gridBagConstraints);

        add(methodPanel, new java.awt.GridBagConstraints());

        curvePanel.setLayout(new java.awt.BorderLayout());
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 9;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.SOUTH;
        add(curvePanel, gridBagConstraints);

        flowPanel.setLayout(new java.awt.GridBagLayout());

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.ipadx = 13;
        gridBagConstraints.insets = new java.awt.Insets(13, 29, 0, 23);
        flowPanel.add(familyIndexComboBox, gridBagConstraints);

        familyIndexLabel.setText("Family Index");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 0;
        flowPanel.add(familyIndexLabel, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.ipadx = 7;
        gridBagConstraints.insets = new java.awt.Insets(13, 31, 0, 18);
        flowPanel.add(directionComboBox, gridBagConstraints);

        directionLabel.setText("Direction");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 0;
        flowPanel.add(directionLabel, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.ipadx = 33;
        gridBagConstraints.insets = new java.awt.Insets(13, 0, 0, 0);
        flowPanel.add(flowComboBox, gridBagConstraints);

        flowLabel.setText("Flow");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 0;
        flowPanel.add(flowLabel, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridwidth = 6;
        gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 20);
        add(flowPanel, gridBagConstraints);
    }// </editor-fold>//GEN-END:initComponents
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JPanel curvePanel;
    private javax.swing.JComboBox directionComboBox;
    private javax.swing.JLabel directionLabel;
    private javax.swing.JComboBox familyIndexComboBox;
    private javax.swing.JLabel familyIndexLabel;
    private javax.swing.JComboBox flowComboBox;
    private javax.swing.JLabel flowLabel;
    private javax.swing.JPanel flowPanel;
    private javax.swing.JComboBox methodComboBox;
    private javax.swing.JLabel methodLabel;
    private javax.swing.JPanel methodPanel;
    // End of variables declaration//GEN-END:variables
    private void addMethodNames() {

        methodComboBox.addItem("ContinuationRarefactionMethod");
        methodComboBox.addItem("RarefactionMethod");
        methodComboBox.addActionListener(new MethodAction());
    }

    private void addFlowNames() {

        flowComboBox.addItem("RarefactionFlow");
        flowComboBox.addItem("ShockFlow");
        flowComboBox.addActionListener(new FlowAction());
    }

    private void directionNames() {

        directionComboBox.addItem("Forward");
        directionComboBox.addItem("Backward");
    }

    private void addFamilyIndex() {

        for (int i = 0; i < RpNumerics.domainDim(); i++) {
            familyIndexComboBox.addItem(new Integer(i));
        }
        familyIndexComboBox.addActionListener(new FamilyIndexAction());

    }

    private class MethodAction implements ActionListener {

        public void actionPerformed(ActionEvent e) {
            JComboBox combo = (JComboBox) e.getSource();
            CurvePlotAgent.instance().setMethodName((String) methodComboBox.getSelectedItem());

        }
    }

    private class FlowAction implements ActionListener {

        public void actionPerformed(ActionEvent e) {
            JComboBox combo = (JComboBox) e.getSource();
            CurvePlotAgent.instance().setFlowName((String) flowComboBox.getSelectedItem());
            if (((String) flowComboBox.getSelectedItem()).matches(".*Shock.*")) {//TODO HardCoded !!Only to show a possible behaviour
                familyIndexComboBox.setEnabled(false);
                directionComboBox.setEnabled(false);
                CurvePlotAgent.instance().setType("shock");
            } else {
                directionComboBox.setEnabled(true);
                familyIndexComboBox.setEnabled(true);
                CurvePlotAgent.instance().setType("rarefaction");
            }
        }
    }

    private class FamilyIndexAction implements ActionListener {

        public void actionPerformed(ActionEvent e) {
            JComboBox combo = (JComboBox) e.getSource();
            CurvePlotAgent.instance().setFamilyIndex(((Integer) familyIndexComboBox.getSelectedItem()).intValue());

        }
    }

    private class DirectionAction implements ActionListener {

        public void actionPerformed(ActionEvent e) {
            JComboBox combo = (JComboBox) e.getSource();

            if (((String) combo.getSelectedItem()).matches("Forward")) {
                CurvePlotAgent.instance().setTimeDirection(1);
            } else {
                CurvePlotAgent.instance().setTimeDirection(-1);
            }
        }
    }
}
